[pytest]
# Django settings module for tests
DJANGO_SETTINGS_MODULE = rumo_rush.settings.testing

# Python file patterns for test discovery
python_files = tests.py test_*.py *_tests.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = tests apps

# Output and logging
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --cov=apps
    --cov-report=html
    --cov-report=term-missing:skip-covered
    --cov-report=xml
    --cov-branch
    --cov-fail-under=80

# Markers for organizing tests
markers =
    unit: Unit tests for models, serializers, utils
    integration: Integration tests for API endpoints
    api: API endpoint tests requiring HTTP calls
    slow: Slow running tests (>1 second)
    celery: Celery task tests
    payment: Payment processing tests
    websocket: WebSocket tests
    smoke: Smoke tests for critical features
    regression: Regression tests for known issues
    performance: Performance and stress tests

# Database configuration
# Use PostgreSQL for consistency with production
DB_NAME = test_rumo_rush
DB_USER = postgres
DB_PASSWORD = password
DB_HOST = localhost
DB_PORT = 5432

# Cache for tests
CACHE_LOCATION = redis://localhost:6379/15

# Celery settings
CELERY_TASK_ALWAYS_EAGER = True
CELERY_TASK_EAGER_PROPAGATES = True

# Timeout for tests
timeout = 300

# Parallel execution
# Uncomment to run tests in parallel (requires pytest-xdist)
# addopts = -n auto

# Capture output
console_output_style = progress

# Ignore warnings from specific packages
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning
    error::UserWarning:apps.*
